<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Coding Challenge</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
  background: linear-gradient(135deg,#c9b6f3,#8ec5fc);
  font-family: Inter, sans-serif;
}

.card{
  border-radius:18px;
  box-shadow:0 12px 30px rgba(0,0,0,.15);
  animation: pop .4s ease;
}

@keyframes pop{
  from{transform:scale(.9);opacity:0}
  to{transform:scale(1);opacity:1}
}

.timer{
  font-weight:600;
  color:#ef4444;
}

textarea{
  font-family: monospace;
}

.result{
  font-size:20px;
  font-weight:600;
}
</style>
</head>

<body>

<div class="container my-5">
  <div class="card p-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4>üíª Coding Challenge</h4>
      <div class="timer">‚è± Time: <span id="time">60</span>s</div>
    </div>

    <p class="text-muted">
      Question <span id="qIndex">1</span> / 5
    </p>

    <h5 id="questionText"></h5>

    <textarea id="codeArea" class="form-control my-3" rows="6"
      placeholder="Write your code here..."></textarea>

    <div class="d-flex gap-2">
      <button class="btn btn-primary" onclick="runCode()">‚ñ∂ Run Code</button>
      <button id="nextBtn" class="btn btn-success" onclick="nextQuestion()">Next</button>

      <!-- üî• ADDED -->
      <button id="submitBtn" class="btn btn-dark d-none" onclick="submitCoding()">
        Submit & Go to Dashboard
      </button>
    </div>

    <div id="output" class="alert alert-secondary mt-3 d-none"></div>
    <div id="finalResult" class="alert alert-success mt-3 d-none"></div>

  </div>
</div>

<script>
/* ================= QUESTIONS ================= */
const questions = [
  {
    q: "Write a function to add two numbers.",
    test: code => code.includes("return")
  },
  {
    q: "Print numbers from 1 to 5 using a loop.",
    test: code => code.includes("for") || code.includes("while")
  },
  {
    q: "Check if a number is even.",
    test: code => code.includes("%")
  },
  {
    q: "Create an array with 3 values.",
    test: code => code.includes("[")
  },
  {
    q: "Log 'Hello World' to console.",
    test: code => code.includes("console.log")
  }
];

let current = 0;
let score = 0;
let time = 60;
let timer;

/* ================= INIT ================= */
loadQuestion();
startTimer();

/* ================= LOAD ================= */
function loadQuestion(){
  document.getElementById("qIndex").innerText = current + 1;
  document.getElementById("questionText").innerText = questions[current].q;
  document.getElementById("codeArea").value = "";
  document.getElementById("output").classList.add("d-none");
  resetTimer();
}

/* ================= TIMER ================= */
function startTimer(){
  timer = setInterval(()=>{
    time--;
    document.getElementById("time").innerText = time;
    if(time === 0){
      nextQuestion();
    }
  },1000);
}

function resetTimer(){
  clearInterval(timer);
  time = 60;
  document.getElementById("time").innerText = time;
  startTimer();
}

/* ================= RUN CODE ================= */
function runCode(){
  const code = document.getElementById("codeArea").value;
  const output = document.getElementById("output");

  if(questions[current].test(code)){
    output.className = "alert alert-success mt-3";
    output.innerText = "‚úÖ Code looks correct!";
    score++;
  }else{
    output.className = "alert alert-danger mt-3";
    output.innerText = "‚ùå Try improving your logic.";
  }

  output.classList.remove("d-none");
}

/* ================= NEXT ================= */
function nextQuestion(){
  clearInterval(timer);
  current++;

  if(current < questions.length){
    loadQuestion();
  }else{
    showResult();
  }
}

/* ================= RESULT ================= */
function showResult(){
  const result = document.getElementById("finalResult");
  const percent = Math.round((score / questions.length) * 100);

  let message = "Good effort!";
  if(percent >= 80) message = "üî• Excellent coding skills!";
  else if(percent >= 50) message = "üëè Nice work, keep practicing!";
  else message = "üí™ Don‚Äôt worry, practice makes perfect!";

  result.innerHTML = `
    <div class="result">
      ${message}<br>
      Score: ${score} / ${questions.length} (${percent}%)
    </div>
  `;

  result.classList.remove("d-none");

  // üî• ADDED: show submit, hide next
  document.getElementById("nextBtn").classList.add("d-none");
  document.getElementById("submitBtn").classList.remove("d-none");
}

/* ================= SUBMIT (NEW) ================= */
function submitCoding(){
  // redirect to assessment dashboard
  window.location.href = "assessment.html"; 
  // or: window.location.href = "dashboard.html";
}
</script>

</body>
</html>
